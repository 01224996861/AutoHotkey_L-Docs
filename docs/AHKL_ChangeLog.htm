<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Changes &amp; New Features</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Changes &amp; New Features</h1>
<p>This changelog only concerns AutoHotkey_L. Read <a href="ChangeLogHelp.htm">AutoHotkey's changelog</a>.</p>

<!--new revisions go here-->
<h2>Revision 55 - August 19, 2010</h2>
<p>Fixed: GroupActivate not setting ErrorLevel=1 if no Label was specified.</p>
<p>Fixed: Tab controls in x64 build.</p>
<p>Fixed: String-copy mode of StrPut when length is omitted; broken by L53.</p>
<p>Fixed: Data-alignment issues in x64 builds.</p>
<p>Changed: Set A_LastError for more File* commands to assist debugging.</p>
<p>Includes FileAppend, FileRead, FileReadLine, FileDelete, FileCopy, FileMove, FileGetAttrib/Time/Size/Version and FileSetAttrib/Time.</p>
<p>Excludes FileCopyDir, FileRecycle, FileMoveDir, FileRemoveDir, FileRecycleEmpty, FileCreateDir and FileInstall as the APIs used do not consistently set or return a Win32 error code.</p>

<h2>Revision 54 - August 15, 2010</h2>
<p>Fixed: RunAs in Unicode build. <a href="http://www.autohotkey.com/forum/viewtopic.php?p=372973#372973">[jackieku]</a></p>
<p>Fixed: RegisterCallback in x64 build. <a href="http://www.autohotkey.com/forum/viewtopic.php?p=374773#374773">[fincs]</a></p>
<p>Fixed: Executables failing to run on Win2k and WinXP prior to SP2. Win2k requires SP4 and updates (probably <a href="http://support.microsoft.com/kb/816542">KB 816542</a>). XP not tested.</p>
<p>Fixed: Dialogs such as MsgBox became unresponsive when interrupted by another script thread. Message filter/workaround added in L45 had to be removed. <a href="http://www.autohotkey.com/forum/viewtopic.php?p=358029#358029">[Bug report]</a></p>
<p>Fixed: Multi-byte characters in default ANSI codepage; this was also causing a memory leak. <a href="http://www.autohotkey.com/forum/viewtopic.php?p=375342#375342">[Bug report]</a></p>
<p>Fixed: ComObject now allows purely numeric property/method names. <a href="http://www.autohotkey.com/forum/viewtopic.php?p=375393#375393">[Bug report]</a></p>
<p>Enhanced usability and capabilities of FileOpen/File object.</p>
<ul>
  <li>FileOpen's <i>Flags</i> parameter accepts a human-readable string of flags.</li>
  <li>FileOpen's "update" mode has been renamed "read/write" and now creates the file if it didn't already exist.</li>
  <li>FileOpen sets A_LastError as appropriate.</li>
  <li><code>File := FileOpen(handle,"h")</code> wraps an existing file handle in an object.</li>
  <li><code>File.Seek(n)</code> defaults to SEEK_END when n is negative.</li>
  <li><code>File.Pos</code> (or <code>File.Position</code>) can be used in place of Tell and Seek.</li>
  <li><code>File.Pos</code>, <code>File.Length</code>, <code>File.AtEOF</code> and <code>File.__Handle</code> can be used without empty parentheses<code>()</code>.</li>
  <li><code>File.Length</code> can be set, as in <code>File.Length:=n</code>.</li>
  <li><code>File.Read<i>Num</i>()</code> and <code>File.Write<i>Num</i>(n)</code> read or write a number, where <i>Num</i> is a NumGet-compatible type name.</li>
  <li><code>File.WriteLine(s)</code> is equivalent to <code>File.Write(s "`n")</code>, for symmetry with <code>File.ReadLine()</code>.</li>
  <li><code>File.Read()</code> reads and returns the remainder of the file when used without parameters.</li>
  <li>File object now returns "" for unrecognized methods and invalid syntax rather than the numeric <i>address</i> of "".</li>
</ul>
<p>Changed: GroupAdd's Label parameter now applies to the whole group. <a href="http://www.autohotkey.com/forum/topic61362.html">[Discussion]</a></p>
<p>Changed: GroupActivate sets ErrorLevel on success/failure. (Same thread as above.)</p>
<p>Changed: <code>*/</code> at the beginning of a line is ignored if there was no <code>/*</code>. <a href="http://www.autohotkey.com/forum/topic61109.html">[Discussion]</a></p>
<p>Removed ToCodePage and FromCodePage subcommands of Transform.</p>

<h2>Revision 53 - August 8, 2010</h2>

<p><b>Merged AutoHotkey64</b> - COM support and x64 compatibility.</p>
<p><b>x64</b> (<i>changes since AutoHotkey64</i>):</p>
<ul>
  <li>Fixed floating-point return values and exception handling for DllCall.</li>
  <li>Fixed RegEx callouts.</li>
  <li>Re-enabled GetProcAddress optimisation for DllCall.</li>
  <li>NumPut and NumGet default to "Int64" in x64 builds.</li>
</ul>
<p><b>COM</b> (<i>changes since AutoHotkey64</i>):</p>
<ul>
  <li>Allow ComObjParameter to wrap 64-bit values in 32-bit builds.</li>
  <li>Implemented more standard ref counting conventions in ComObjActive.</li>
  <li>Prevent extraneous AddRef for new ComObjects in certain cases.</li>
  <li>Don't treat pdispVal==NULL return value from Invoke as an error.</li>
  <li>Fail more predictably when given wrong type of object.</li>
  <li>Require explicit second param in ComObjType, don't assume "IID".</li>
  <li>Free local vars after ComEvent calls a function.</li>
  <li>Remove pVarResult param from ComEvent; use return value instead.</li>
  <li>Pass the original wrapper ComObject in each ComEvent call.</li>
  <li>Add context to ComError dialog; let the buttons make more sense.</li>
</ul>
<p>Implemented common syntax validation code for enumerators. <code>Enum[]</code> and <code>Enum.Next()</code> are now supported with or without parameters. <code>Enum[]:=val</code> and similar obscure forms which worked in AutoHotkey_COM/AutoHotkey64 are not allowed.</p>
<p>"Ptr" type is still signed (unlike AutoHotkey64), for maximum flexibility and consistency.</p>
<p><b>Other changes:</b></p>
<p>Added: <code>Object.<b>HasKey</b>(key)</code>.</p>
<p>Added: <code>Object(obj)</code> increments obj's reference count and returns its address.</p>
<p>Added: <code>ObjAddRef()</code> and <code>ObjRelease()</code>.</p>
<p>Fixed: A_ThisHotkey now has the expected value when used with #If.</p>
<p>Fixed: RunAs in Unicode build (fixed by jackieku).</p>
<p>Changed: Default script codepage for ANSI builds is now CP0 (ANSI).</p>
<p>Changed: <code>x.y[]</code> is now equivalent to <code>(x.y)[]</code> rather than <code>x["y"]</code>.</p>
<p>Changed: Built-in methods can now be called with or without the underscore prefix (e.g. <code>obj.MaxIndex()</code> or <code>obj._MaxIndex()</code>).</p>

<h2>Revision 52 (again) - July 10, 2010</h2>
<p>Added support for built-in and environment variables in double-derefs.</p>
<p>Improved support for multi-byte characters in certain codepages (previously only 932, 936, 949, 950 and 1361 were supported).</p>
<p>Fixed: StrPut failed for codepages which don't support WC_NO_BEST_FIT_CHARS, such as UTF-7.</p>
<p>Fixed: Double-deref as object - <code>literal%var%.literal</code>.</p>
<p>Fixed: <code>StrPut("", Encoding)</code> null-terminated an invalid address.</p>

<h2>Revision 52 - June 12, 2010</h2>
<p>Fixed: ObjRemove's Key parameter is now optional, as with <a href="objects/Object.htm#Remove">Object._Remove</a>.</p>
<p>Fixed: Files were improperly locked while reading, unlike in older versions.</p>
<p>Fixed: Uppercase Hex format caused negative integers to become unsigned.</p>
<p>Fixed: RegExMatch was corrupting output array items when specific conditions were met. See <a href="http://www.autohotkey.com/forum/topic59120.html">bug report</a>.</p>

<h2>Revision 51 - April 11, 2010</h2>
<p>Changed: Use &lt;EXENAME&gt;.ahk instead of AutoHotkey.ini or AutoHotkey.ahk.</p>
<p>Changed: Default to UTF-8 for script files; override with /CPnnn.</p>
<p>Fixed: Unpause when the script exits so that object __Delete meta-functions can run.</p>

<h2>Revision 50 - March 27, 2010</h2>
<p>Improved flexibility of <a href="objects/Object.htm#Insert">Object._Insert</a>.
<ul>
  <li><code>Object._Insert(x)</code> - inserts x at <code>_MaxIndex()="" ? 1 : _MaxIndex() + 1</code>.</li>
  <li><code>Object._Insert(i,x,y,z)</code> - inserts <code>x,y,z</code> at <code>i,i+1,i+2</code>.</p></li>
</ul>
<p>Improved flexibility of <a href="objects/Object.htm#Remove">Object._Remove</a>.
<ul>
  <li><code>Object._Remove(k)</code> - removes and returns the value associated with k.</li>
  <li><code>Object._Remove()</code> - removes and returns the value at _MaxIndex().</p></li>
</ul>
<p>Added file share mode flags to FileOpen [by jackieku].</p>
<p>Fixed: 'P' option of RegExMatch incorrectly output 1 for subpatterns which did not match anything.</p>
<p>Fixed: <code>Object._SetCapacity(key,n)</code> was not null-terminating in some cases.</p>
<p>Fixed: StatusBarGetText returned only half of the text in Unicode builds.</p>

<h2>Revision 49 - March 14, 2010</h2>
<p>Added <a href="objects/Object.htm#NewEnum">obj._NewEnum()</a>.</p>
<p>Added <a href="objects/Object.htm">ObjMethod(obj)</a> for each built-in <code>obj._Method()</code>.</p>
<p>Changed: ObjSet/Get/Call can no longer be called/overridden by script.</p>
<p>Fixed: Potential crash caused by VK_PACKET check added in L48.</p>
<p>Fixed: Character codes in VK_PACKET events were potentially misinterpreted as scancodes.</p>
<p>Fixed: ExcludeText was ineffective after the first matching control.</p>

<h2>Revision 48 - February 21, 2010</h2>
<p>Fixed: Standalone <code>obj.()</code> was not recognized as a valid expression.</p>
<p>ControlSend now uses WM_CHAR to support characters which have no associated keycode.  For instance, this applies to "&#133;" (en-US), "&#x221e;" in a Unicode build and <code>{U+221e}</code> in either build.</p>
<p>KeyHistory now shows the full 16-bit character code for VK_PACKET (VK=E7) events.  <a href="commands/Send.htm#Unicode">Send</a> may indirectly cause these to be generated for Unicode characters.</p>

<h2>Revision 47 - February 13, 2010</h2>
<p>Fixed (Unicode): ControlGet,List with ListView controls.</p>

<h2>Revision 46 - February 11, 2010</h2>
<p>Added A_FileEncoding, which returns the current default file encoding.</p>
<p>Added <a href="commands/StrPutGet.htm">StrPut</a> and extended <a href="commands/StrPutGet.htm">StrGet</a> with additional features.</p>

<h2>Revision 45 - February 8, 2010</h2>
<p>Added _GetAddress; _SetCapacity/_GetCapacity may now operate on a given field.  <a href="objects/Object.htm">[more info]</a></p>
<p>Added workaround for WM_PAINT infinite loop often caused by subclassing.</p>
<p>Allow <code>obj.()</code> as a means to call the default method of an object; equivalent to <code>obj[""]()</code>.</p>
<p>Dev: Added solution and project files for MSBuild 4.0 & VS2010.  <a href="http://github.com/Lexikos/AutoHotkey_L/commit/ed81ea089c223b46c883036c14454aa4386d3801">[more info]</a></p>
<p>Fixed (Unicode): 'Running' column in ListHotkeys.</p>

<h2>Revision 44 - February 7, 2010</h2>
<p>Fixed: Attempting to set "nothing" crashed the script. For instance, <code>x[]:=z</code>.</p>
<p>Fixed (Unicode): Unable to find default script (Documents\AutoHotkey.ahk).</p>
<p>Fixed (Unicode): A_Desktop, A_ProgramFiles and several other built-in variables which read their value from the registry caused strings to be incorrectly terminated.</p>
<p>Fixed (ANSI): Characters in the range 0x80-0xFF couldn't be found by InStr or StringReplace.</p>
<p>Changed (ANSI): Treat ToCodePage/FromCodePage like other unsupported/invalid subcommands.</p>

<h2>Revision 43 - January 29, 2010</h2>
<p>Fixed: obj.Func() resulting in a random integer when it should be an empty string.</p>

<h2>Revision 42 - January 28, 2010</h2>
<p>Merged with AutoHotkeyU.  See <a href="http://www.autohotkey.net/~Lexikos/AutoHotkey_L/docs/LvsU.htm">comparison of features</a>.</p>
<p>Numerous bug-fixes and improvements, some relating to the merge.</p>

<p>&nbsp;</p>
</div>
<hr>
<p>History from previous years can be found under <a href="AHKL_ChangeLogOld.htm">Ancient History</a>; detailed history at <a href="http://github.com/Lexikos/AutoHotkey_L/commits/master">github</a>.</p>
</body>
</html>
