<!DOCTYPE HTML>
<html lang="en">
<head>
<title>ControlGetTab - Syntax &amp; Usage | AutoHotkey v2</title>
<meta name="description" content="The ControlGetTab function returns the position number of the selected tab in a SysTabControl32." />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlGetTab</h1>

<p>Returns the position number of the selected tab in a SysTabControl32.</p>

<pre class="Syntax">Tab := <span class="func">ControlGetTab</span>(<span class="optional">Control, WinTitle, WinText, ExcludeTitle, ExcludeText</span>)</pre>

<h2>Parameters</h2>
<dl>
    <dt>Control</dt>
    <dd>
        <p>Can be either ClassNN (the classname and instance number of the control) or the control's text, both of which can be determined via Window Spy. When using text, the matching behavior is determined by <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>. If this parameter is blank, the target window's topmost control will be used.</p>
        <p>To operate upon a control's HWND (window handle), leave the <em>Control</em> parameter blank and specify <code>"ahk_id " ControlHwnd</code> for the <em>WinTitle</em> parameter (this also works on hidden controls even when <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> is Off). The HWND of a control is typically retrieved via <a href="ControlGetHwnd.htm">ControlGetHwnd</a>, <a href="MouseGetPos.htm">MouseGetPos</a>, or <a href="DllCall.htm">DllCall</a>.</p>
    </dd>
    <dt>WinTitle</dt>
    <dd>A window title or other criteria identifying the target window. See <a href="../misc/WinTitle.htm">WinTitle</a>.</dd>
    <dt>WinText</dt>
    <dd>If present, this parameter must be a substring from a single text element of the target window (as revealed by the included Window Spy utility). Hidden text elements are detected if <a href="DetectHiddenText.htm">DetectHiddenText</a> is ON.</dd>
    <dt>ExcludeTitle</dt>
    <dd>Windows whose titles include this value will not be considered.</dd>
    <dt>ExcludeText</dt>
    <dd>Windows whose text include this value will not be considered.</dd>
</dl>

<h2>Return Value</h2>
<p>This function returns a <a href="../Concepts.htm#numbers">decimal integer</a> representing the position number of the selected tab in a SysTabControl32. The first tab is 1, the second is 2, etc. If no tab is selected (rare), the return value is 0.</p>

<h2>Error Handling</h2>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> is set to 1 if there was a problem or 0 otherwise.</p>
<p>An <a href="Catch.htm#RuntimeErrors">exception</a> is thrown if invalid parameters are detected.</p>

<h2>Remarks</h2>
<p>To instead discover how many tabs (pages) exist in a tab control, follow this example:</p>
<pre>TabCount := <a href="PostMessage.htm">SendMessage</a>(0x1304,,, "SysTabControl321", WinTitle)  <em>; 0x1304 is TCM_GETITEMCOUNT.</em></pre>
<p>To discover the ClassNN or HWND of the control that the mouse is currently hovering over, use <a href="MouseGetPos.htm">MouseGetPos</a>.</p>
<p>Window titles and text are case sensitive. Hidden windows are not detected unless <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> has been turned on.</p>

<h2>Related</h2>
<p><a href="ControlSetTab.htm">ControlSetTab</a>, <a href="../objects/GuiControl.htm#Value">Value property (GuiControl object)</a>, <a href="Control.htm">Control functions</a></p>

<h2>Examples</h2>

<h3 id="ex1">Example #1</h3>
<p>Retrieves the active tab number of the first Tab control:</p>
<pre class="NoIndent">WhichTab := ControlGetTab("SysTabControl321", "Some Window Title")
if ErrorLevel
    MsgBox("There was a problem.")
else
    MsgBox("Tab #" WhichTab " is active.")</pre>

</body>
</html>
