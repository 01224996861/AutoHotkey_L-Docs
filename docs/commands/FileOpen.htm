<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>FileOpen</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../css/commands.css" rel="stylesheet" type="text/css">
<link href="../css/print.css" rel="stylesheet" type="text/css" media="print">
</head>
<body>

<h1>FileOpen</h1>
<hr size="2">
<p>Opens a file. Available in AutoHotkey_L only.</p>
<p class="CommandSyntax">file := FileOpen(Filename, Flags [, Encoding])</p>

<h4>Parameters</h4>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%">Filename</td><td width="85%">The path of the file to open, which is assumed to be in <a href="../Variables.htm#WorkingDir">A_WorkingDir</a> if an absolute path isn't specified.</td></tr>
  <tr><td>Flags</td><td>A combination (sum) of the values described below. </td></tr>
  <tr><td>Encoding</td><td>The code page to use for text I/O if the file does not contain a UTF-8 or UTF-16 <a href="http://en.wikipedia.org/wiki/Byte_order_mark">byte order mark</a>.<br> If omitted, the current value of <a href="../Variables.htm#FileEncoding">A_FileEncoding</a> is used.</td></tr>
</table>
<br>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><th></th><th style="text-align:left">Access modes (mutually-exclusive)</th></tr>
  <tr><td style="width:3em">0x00</td><td><i>Read:</i> Fails when the file doesn't exist.</td></tr>
  <tr><td>0x01</td><td><i>Write:</i> Creates a new file, <b style="color:red">overwriting any existing file.</b></td></tr>
  <tr><td>0x02</td><td><i>Append:</i> Creates a new file if the file didn't exist.</td></tr>
  <tr><td>0x03</td><td><i>Update (read/write):</i> Fails if the file doesn't exist.</td></tr>
  <tr><th></th><th style="text-align:left">Sharing mode flags</th></tr>
  <tr><td>0x100</td><td>Shares <i>read</i> access.</td></tr>
  <tr><td>0x200</td><td>Shares <i>write</i> access.</td></tr>
  <tr><td>0x400</td><td>Shares <i>delete</i> access.</td></tr>
  <tr><th></th><th style="text-align:left">End of line (EOL) options</th></tr>
  <tr><td>0x04</td><td>Replace <code>`r`n</code> with <code>`n</code> when reading and <code>`n</code> with <code>`r`n</code> when writing.</td></tr>
  <tr><td>0x08</td><td>Replace standalone <code>`r</code> with <code>`n</code> when reading.</td></tr>
</table>

<h4>Return Value</h4>
<p>If the file is opened successfully, the return value is a <a href="../objects/File.htm">File object</a>.  If the function fails, the return value is 0.</p>
<p>Use <code>if file</code> or <code>IsObject(file)</code> to check if the function succeeded.

<h4>Remarks</h4>
<p>When a UTF-8 or UTF-16 file is created, a byte order mark is written to the file <b>unless</b> <i>Encoding</i> (or <i>A_FileEncoding</i> if <i>Encoding</i> is omitted) contains "UTF-8-RAW" or "UTF-16-RAW".</p>

<h4>Related</h4>
<p><a href="FileEncoding.htm">FileEncoding</a>, <a href="../objects/File.htm">File Object</a>, <a href="FileRead.htm">FileRead</a></p>

</body>
</html>
