<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>GroupAdd</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../css/commands.css" rel="stylesheet" type="text/css">
<link href="../css/print.css" rel="stylesheet" type="text/css" media="print">
</head>
<body>

<h1>GroupAdd</h1>
<hr size="2">
<p>Adds a window specification to a window group, creating the group if necessary.</p>

<p class="CommandSyntax">GroupAdd, GroupName [, WinTitle, WinText, Label, ExcludeTitle, ExcludeText]</p>
<h4>Parameters</h4>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr> 
    <td width="15%">GroupName</td>
    <td width="85%">The name of the group to which to add this window specification. If the group doesn't exist, it will be created. Group names are not case sensitive. </td>
  </tr>
  <tr>
    <td>WinTitle</td>
    <td><p>The title or partial title of the target window(s). It can be blank. <strong>Note</strong>: Although <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> and <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> do not directly affect the behavior of this command, they do affect the other group commands such as <a href="GroupActivate.htm">GroupActivate</a> and <a href="GroupClose.htm">GroupClose</a>. They also affect the use of ahk_group in any other command's <em>WinTitle</em>.</p>
      <p>To use a window class, specify ahk_class ExactClassName (shown by Window Spy). To use a <a href="Process.htm">process identifier (PID)</a>, specify ahk_pid %VarContainingPID%.</p>
      <p>To use a window's <a href="WinGet.htm">unique ID number</a>, specify ahk_id %VarContainingID%. To use a window group, specify ahk_group GroupName (i.e. groups may contain other groups).</p>
      <p>The search can be narrowed by specifying <a href="../LastFoundWindow.htm#multi">multiple criteria</a>. For example: <em>My File.txt ahk_class Notepad</em></p></td>
  </tr>
  <tr>
    <td>WinText</td>
    <td>If present, this parameter must be a substring from a single text element of the target window (as revealed by the included Window Spy utility). Hidden text elements are detected if <a href="DetectHiddenText.htm">DetectHiddenText</a> is ON at the time that <a href="GroupActivate.htm">GroupActivate</a>, <a href="GroupDeactivate.htm">GroupDeactivate</a>, and <a href="GroupClose.htm">GroupClose</a> are used.</td>
  </tr>
  <tr>
    <td>Label</td>
    <td>The label of a subroutine to run if no windows matching this specification exist when the <a href="GroupActivate.htm">GroupActivate</a> command is used. The label is jumped to as though a <a href="Gosub.htm">Gosub</a> had been used. Omit or leave blank for none.</td>
  </tr>
  <tr>
    <td>ExcludeTitle</td>
    <td>Windows whose titles include this value will not be considered.</td>
  </tr>
  <tr>
    <td>ExcludeText</td>
    <td>Windows whose text include this value will not be considered.</td>
  </tr>
</table>

<h4>Remarks</h4>
<p>Each use of this command adds a new rule to a group. In other words,  a group consists of a set of criteria rather than a fixed list of windows. Later, when a group is used by a command such as <a href="GroupActivate.htm">GroupActivate</a>, each window on the desktop is checked against each of these criteria. If a window matches one of the criteria in the group, it is considered a match.</p>
<p>A window group is typically used to bind together a collection of related windows, which is useful for tasks that involve many related windows, or an application that owns many subwindows. For example, if you frequently work with many instances of a graphics program or text editor, you can use <a href="GroupActivate.htm">GroupActivate</a> on a hotkey to visit each instance of that program, one at a time, without having to use alt-tab or task bar buttons to locate them.</p>
<p>Since the entries in each group need to be added only once, this command is typically used in the auto-execute section (top part of the script). Attempts to add duplicate entries to a group are ignored.</p>
<p>To include <u>all</u> windows in a group (except the special Program Manager window), use this example:</p>
<pre>GroupAdd, AllWindows</pre>
<p>All windowing commands can operate upon a window group by specifying <em>ahk_group MyGroupName</em> for the <em>WinTitle</em> parameter. The commands <a href="WinMinimize.htm">WinMinimize</a>, <a href="WinMaximize.htm">WinMaximize</a>, <a href="WinRestore.htm">WinRestore</a>, <a href="WinHide.htm">WinHide</a>, <a href="WinShow.htm">WinShow</a>, <a href="WinClose.htm">WinClose</a>, and <a href="WinKill.htm">WinKill</a> will act upon <strong>all</strong> the group's windows. To instead act upon only the topmost window, follow this example:</p>
<pre>WinHide % &quot;ahk_id &quot; . WinExist(&quot;ahk_group <strong>MyGroup</strong>&quot;)</pre>
<p>By contrast, the other window commands such as <a href="WinActivate.htm">WinActivate</a> and <a href="IfWinExist.htm">IfWinExist</a> will operate only upon the topmost window of the group.</p>
<h4>Related</h4>
<p><a href="GroupActivate.htm">GroupActivate</a>, <a href="GroupDeactivate.htm">GroupDeactivate</a>, <a href="GroupClose.htm">GroupClose</a></p>
<h4>Examples</h4>
<pre class="NoIndent"><span class="CodeCom">; In the autoexecute section at the top of the script: </span>
GroupAdd, MSIE, ahk_class IEFrame <span class="CodeCom">; Add only Internet Explorer windows to this group.</span>
return <span class="CodeCom">; End of autoexecute section.</span>

<span class="CodeCom">; Assign a hotkey to activate this group, which traverses</span>
<span class="CodeCom">; through all open MSIE windows, one at a time (i.e. each</span>
<span class="CodeCom">; press of the hotkey).</span>
Numpad1::GroupActivate, MSIE, r

<span class="CodeCom">; Here's a more complex group for MS Outlook 2002.</span>
<span class="CodeCom">; In the autoexecute section at the top of the script: </span>
SetTitleMatchMode, 2 
GroupAdd, mail, Message - Microsoft Word <span class="CodeCom">; This is for mails currently being composed </span>
GroupAdd, mail, - Message ( <span class="CodeCom">; This is for already opened items </span>
<span class="CodeCom">; Need extra text to avoid activation of a phantom window:</span>
GroupAdd, mail, Advanced Find, Sear&amp;ch for the word(s)
GroupAdd, mail, , Recurrence: 
GroupAdd, mail, Reminder 
GroupAdd, mail, - Microsoft Outlook 
return  <span class="CodeCom">; End of autoexecute section.</span>


Numpad5::GroupActivate, mail <span class="CodeCom">; Assign a hotkey to visit each Outlook window, one at a time.</span></pre>

</body>
</html>
