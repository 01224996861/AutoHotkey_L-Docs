<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>#Include</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../css/commands.css" rel="stylesheet" type="text/css">
<link href="../css/print.css" rel="stylesheet" type="text/css" media="print">
</head>
<body>

<h1>#Include / #IncludeAgain</h1>
<hr size="2">
<p>Causes the script to behave as though the specified file's contents are present at this exact position.</p>

<p class="CommandSyntax">#Include FileOrDirName<br>
    #IncludeAgain FileOrDirName </p>
<h4>Parameters</h4>
<table width="100%" border="1" cellpadding="3" cellspacing="0" bordercolor="#C0C0C0">
  <tr>
    <td width="15%" height="24">FileOrDirName</td>
    <td width="85%"><p><strong>File:</strong> The name of the file to be included, which is assumed to be in the startup/working directory if an absolute path is not specified (except for <a href="../Scripts.htm#ahk2exe">ahk2exe</a>, which assumes the file is in the script's own directory). The file name <strong>must not</strong> contain variable references (except <a href="../Variables.htm#ScriptDir">%A_ScriptDir%</a>, <a href="../Variables.htm#AppData">%A_AppData%</a>, and <a href="../Variables.htm#AppDataCommon">%A_AppDataCommon%</a>), double quotes, or wildcards. <a href="_EscapeChar.htm">Escape sequences</a> other than semicolon (<strong>`;</strong>) must not be used, nor are they needed because characters such as percent signs are treated literally. Note: <a href="SetWorkingDir.htm">SetWorkingDir</a> has no effect on #Include because #Include is processed before the script begins executing.</p>
      <p><strong>Directory:</strong> Specify a directory instead of a file to change the working directory used by all subsequent occurrences of #Include and <a href="FileInstall.htm">FileInstall</a>. The directory name must not contain variables other than <a href="../Variables.htm#ScriptDir">%A_ScriptDir%</a>, <a href="../Variables.htm#AppData">%A_AppData%</a>, and <a href="../Variables.htm#AppDataCommon">%A_AppDataCommon%</a>. Note: Changing the working directory in this way does not affect the script's initial working directory when it starts running (<a href="../Variables.htm#WorkingDir">A_WorkingDir</a>). To change that, use <a href="SetWorkingDir.htm">SetWorkingDir</a> at the top of the script.</p></td>
  </tr>
</table>
<h4>Remarks</h4>
<p>A script behaves as though the included file's contents are physically present at the exact position of the #Include directive (as though a copy-and-paste were done from the included file). Consequently, it generally cannot merge two isolated scripts together into one functioning script (to achieve that, see <a href="http://www.autohotkey.com/forum/topic18545.html">www.autohotkey.com/forum/topic18545.html</a>).</p>
<p>#Include ensures that <em>FileName</em> is included only once, even if multiple inclusions are encountered for it. By contrast, #IncludeAgain allows multiple inclusions of the same file, while being the same as #Include in all other respects.</p>
<p>The <em>FileName</em> parameter may optionally be preceded by *i and a single space, which causes the program to ignore any failure to load the included file. For example: <em>#Include *i SpecialOptions.ahk</em>. This option should be used only when the included file's contents are not essential to the main script's operation.</p>
<p>Lines displayed in the main window via <a href="ListLines.htm">ListLines</a> or the menu View-&gt;Lines are always numbered according to their physical order within their own files. In other words, including a new file will change the line numbering of the main script file by only one line, namely that of the #Include line itself (except for <a href="../Scripts.htm#ahk2exe">compiled scripts</a>, which merge their included files into one big script at the time of compilation).</p>
<p>#Include is often used to load <a href="../Functions.htm">functions</a> defined in an external file. Unlike subroutine labels, <a href="../Functions.htm">functions</a> can be included at the very top of the script without affecting the <a href="../Scripts.htm#auto">auto-execute section</a>.</p>
<p>Like other # directives, #Include cannot be executed conditionally. In other words, this example would not work:</p>
<pre>if x = 1
    #Include SomeFile.ahk  <span class="CodeCom">; This line takes effect regardless of the value of x.</span>
    y = 2  <span class="CodeCom">; And this line would belong to the IF above, since # directives cannot belong to IFs.</span></pre>
<p>Files can be automatically included (i.e. without having to use #Include) by calling a <a href="../Functions.htm#lib">library function</a> by name.</p>
<h4>Related</h4>
<p> <a href="../Functions.htm#lib">Libraries of Functions</a>, <a href="../Functions.htm">Functions</a>, <a href="FileInstall.htm">FileInstall</a></p>
<h4>Example</h4>
<pre class="NoIndent">#Include C:\My Documents\Scripts\Utility Subroutines.ahk
#Include %A_ScriptDir%  <span class="CodeCom">; Changes the working directory for subsequent #Includes and FileInstalls.</span>
#Include C:\My Scripts  <span class="CodeCom">; Same as above but for an explicitly named directory.</span></pre>

</body>
</html>
