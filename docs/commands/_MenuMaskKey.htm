<!DOCTYPE HTML>
<html>
<head>
<title>#MenuMaskKey</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>#MenuMaskKey <span class="ver">[AHK_L 38+]</span></h1>

<p>Changes which key is used to mask Win or Alt keyup events.</p>

<pre class="Syntax">#MenuMaskKey KeyName</pre>
<h3>Parameters</h3>
<dl>

  <dt>KeyName</dt>
  <dd><p>A <a href="../KeyList.htm">key name</a> or vkNN sequence which specifies a non-zero virtual keycode.  Scan codes are not used.</p></dd>

</dl>

<h3>Remarks</h3>
<p>The default mask key is Ctrl. This directive can be used to change the mask key to a key with fewer side effects.</p>
<p>This setting is global, meaning that it needs to be specified only once (anywhere in the script) to affect the behavior of the entire script.</p>
<p>The mask key is sent automatically to prevent the Start menu or the active window's menu bar from activating at unexpected times.</p>
<p><strong>Hotkeys:</strong> If a hotkey is implemented using the keyboard hook or mouse hook, the final keypress may be invisible to the active window and the system. If the system was to detect <em>only</em> a Win or Alt keydown and keyup with no intervening keypress, it would usually activate a menu. To prevent this, the keyboard or mouse hook may automatically send the mask key.</p>
<p><strong>Send:</strong> <a href="Send.htm">Send</a>, <a href="ControlSend.htm">ControlSend</a> and related often release modifier keys as part of their normal operation. For example, the hotkey <code>&lt;#a::SendRaw %Address%</code> usually must release the LWin key prior to sending the contents of <em>Address</em>, and press the LWin key back down afterward (so that other Win key combinations continue working). The mask key may be sent in such cases to prevent a Win or Alt keyup from activating a menu.</p>

<h3>Related</h3>
<p>See <a href="https://autohotkey.com/board/topic/20619-extraneous-control-key-presses-generated-by-or-hotkeys/">this thread</a> for background information.</p>

<h3>Examples</h3>
<pre class="NoIndent">#MenuMaskKey vk07  <em>; vk07 is unassigned.</em>
#UseHook
#Space::
!Space::
    KeyWait LWin
    KeyWait RWin
    KeyWait Alt
    KeyHistory
return</pre>

</body>
</html>
