<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>File Object</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../css/commands.css" rel="stylesheet" type="text/css">
<link href="../css/print.css" rel="stylesheet" type="text/css" media="print">
</head>
<body>

<h1>File Object</h1>
<hr size="2">
<p>Provides an interface for file input/output. <a href="../commands/FileOpen.htm">FileOpen</a> returns an object of this type. Available in AutoHotkey_L only.</p>

<div class="methodShort" id="Read"><h2>Read</h2>
<p>Reads the specified number of characters from the file and advances the file pointer.</p>
<p class="CommandSyntax">String := File.Read(Characters)</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%">Characters</td><td width="85%">Number of characters to read.</td></tr>
  <tr><td><b>Returns</b></td><td>A string of <i>up to</i> the specified number of characters.</td></tr>
</table></div>

<div class="methodShort" id="ReadLine"><h2>ReadLine</h2>
<p>Reads a line from the file and advances the file pointer.</p>
<p class="CommandSyntax">Line := File.ReadLine()</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%"><b>Returns</b></td><td width="85%">A line of text.  This may include <code>`n</code>, <code>`r`n</code> or <code>`r</code> depending on the file and EOL flags used to open the file.</td></tr>
</table></div>

<div class="methodShort" id="Write"><h2>Write</h2>
<p>Writes a string to the file.</p>
<p class="CommandSyntax">File.Write(String)</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%">String</td><td width="85%">A string.</td></tr>
  <tr><td><b>Returns</b></td><td>The number of <b>bytes</b> (not characters) that have been written. </td></tr>
</table></div>

<div class="methodShort" id="RawRead"><h2>RawRead</h2>
<p>Read raw binary data from the file.  Callers must ensure that the target is large enough to hold the data (see <a href="../commands/VarSetCapacity.htm">VarSetCapacity</a>).</p>
<p class="CommandSyntax">File.RawRead(VarOrAddress, Bytes)</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%">VarOrAddress</td><td width="85%">A variable or memory address to which the data will be copied.  Usage is similar to <a href="../Functions.htm#NumGet">NumGet</a>.</td></tr>
  <tr><td>Bytes</td><td>The maximum number of bytes to read.</td></tr>
  <tr><td><b>Returns</b></td><td>The number of bytes that have been read.</td></tr>
</table></div>

<div class="methodShort" id="RawWrite"><h2>RawWrite</h2>
<p>Write raw binary data to the file.</p>
<p class="CommandSyntax">File.RawWrite(VarOrAddress, Bytes)</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%">VarOrAddress</td><td width="85%">A variable or memory address from which the data will be copied.  Usage is similar to <a href="../Functions.htm#NumPut">NumPut</a></td></tr>
  <tr><td>Bytes</td><td>The number of bytes to write.</td></tr>
  <tr><td><b>Returns</b></td><td>The number of bytes that have been written.</td></tr>
</table></div>

<div class="methodShort" id="Seek"><h2>Seek</h2>
<p>Moves the file pointer.</p>
<p class="CommandSyntax">File.Seek(Distance [, Origin = 0])</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%">Distance</td><td width="85%">The length in bytes to move.  Negative values reverse the direction.</td></tr>
  <tr><td>Origin</td><td>Specifies the meaning of the <i>Distance</i> parameter; must be one of the following values:<ul>
      <li>0 (SEEK_SET): Relative to the beginning of the file.</li>
      <li>1 (SEEK_CUR): Relative to the current position of the file pointer.</li>
      <li>2 (SEEK_END): Relative to the end of the file.</li>
    </ul></td></tr>
  <tr><td><b>Returns</b></td><td>A non-zero value if successful, otherwise zero. </td></tr>
</table></div>

<div class="methodShort" id="Tell"><h2>Tell</h2>
<p class="CommandSyntax">Pos := File.Tell()</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%"><b>Returns</b></td><td width="85%">The current position of the file pointer.</td></tr>
</table></div>

<div class="methodShort" id="Length"><h2>Length</h2>
<p>Retrieves or sets the size of the file.</p>
<p class="CommandSyntax">FileSize := File.Length([NewSize])</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%">NewSize</td><td width="85%">If specified, the file will be resized to <i>NewSize</i> bytes.</td></tr>
  <tr><td><b>Returns</b></td><td>The size of the file.</td></tr>
</table></div>

<div class="methodShort" id="AtEOF"><h2>AtEOF</h2>
<p class="CommandSyntax">IsAtEOF := File.AtEOF()</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%"><b>Returns</b></td><td width="85%">A non-zero value if the file pointer has reached the end of the file, otherwise zero.</td></tr>
</table></div>

<div class="methodShort" id="Close"><h2>Close</h2>
<p>Closes the file, flushes any data in the cache to disk and releases the share locks.  Although the file is closed automatically when the object is freed, it is recommended to close the file as soon as possible.</p>
<p class="CommandSyntax">File.Close()</p>
<p><i>No parameters or return value.</i></p></div>

<div class="methodShort" id="__Handle"><h2>__Handle</h2>
<p class="CommandSyntax">File.__Handle()</p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr><td width="15%"><b>Returns</b></td><td width="85%">A system file handle, intended for use with DllCall. See <a href="http://msdn.microsoft.com/en-us/library/aa363858.aspx">CreateFile</a>.</td></tr>
</table></div>

</body>
</html>
