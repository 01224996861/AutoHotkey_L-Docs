<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Window Shading (roll up a window to its title bar) -- by Rajat</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="alternate" type="application/rss+xml" title="AutoHotkey Forum RSS" href="/forum/rss.php">
<link href="/docs/css/default.css" rel="stylesheet" type="text/css">
<link href="/docs/css/print.css" rel="stylesheet" type="text/css" media="print">
</head>
<body>

<h6>Window Shading (roll up a window to its title bar) -- by Rajat</h6>

<p> This script reduces a window to its title bar and then back to its
 original size by pressing a single hotkey.  Any number of windows
 can be reduced in this fashion (the script remembers each).  If the
 script exits for any reason, all &quot;rolled up&quot; windows will be
 automatically restored to their original heights.
</p>
<p><a href="WindowShading.ahk">Download This Script</a> &nbsp;| &nbsp;<a href="index.htm">Other Sample Scripts</a> &nbsp;| &nbsp;<a href="http://www.autohotkey.com">Home</a></p>
<hr>
<pre class="NoIndent"><span class="CodeCom">; Set the height of a rolled up window here.  The operating system</span>
<span class="CodeCom">; probably won't allow the title bar to be hidden regardless of</span>
<span class="CodeCom">; how low this number is:</span>
ws_MinHeight = 25

<span class="CodeCom">; This line will unroll any rolled up windows if the script exits</span>
<span class="CodeCom">; for any reason:</span>
OnExit, ExitSub
return  <span class="CodeCom">; End of auto-execute section</span>

#z::  <span class="CodeCom">; Change this line to pick a different hotkey.</span>
<span class="CodeCom">; Below this point, no changes should be made unless you want to</span>
<span class="CodeCom">; alter the script's basic functionality.</span>
<span class="CodeCom">; Uncomment this next line if this subroutine is to be converted</span>
<span class="CodeCom">; into a custom menu item rather than a hotkey.  The delay allows</span>
<span class="CodeCom">; the active window that was deactivated by the displayed menu to</span>
<span class="CodeCom">; become active again:</span>
<span class="CodeCom">;Sleep, 200</span>
WinGet, ws_ID, ID, A
Loop, Parse, ws_IDList, |
{
    IfEqual, A_LoopField, %ws_ID%
    {
        <span class="CodeCom">; Match found, so this window should be restored (unrolled):</span>
        StringTrimRight, ws_Height, ws_Window%ws_ID%, 0
        WinMove, ahk_id %ws_ID%,,,,, %ws_Height%
        StringReplace, ws_IDList, ws_IDList, |%ws_ID%
        return
    }
}
WinGetPos,,,, ws_Height, A
ws_Window%ws_ID% = %ws_Height%
WinMove, ahk_id %ws_ID%,,,,, %ws_MinHeight%
ws_IDList = %ws_IDList%|%ws_ID%
return

ExitSub:
Loop, Parse, ws_IDList, |
{
    if A_LoopField =  <span class="CodeCom">; First field in list is normally blank.</span>
        continue      <span class="CodeCom">; So skip it.</span>
    StringTrimRight, ws_Height, ws_Window%A_LoopField%, 0
    WinMove, ahk_id %A_LoopField%,,,,, %ws_Height%
}
ExitApp  <span class="CodeCom">; Must do this for the OnExit subroutine to actually Exit the script.</span>
</pre>
</body>
</html>
